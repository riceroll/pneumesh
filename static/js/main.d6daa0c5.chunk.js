(this.webpackJsonpreact3=this.webpackJsonpreact3||[]).push([[0],{49:function(e,t,n){},71:function(e,t,n){},79:function(e,t,n){"use strict";n.r(t);var i=n(2),a=n.n(i),o=n(29),s=n.n(o),r=(n(71),n(13)),c=n(16),l=n(3),h=n(4),d=n(1),u=Object(l.a)((function e(t,n,i,a,o){Object(h.a)(this,e),this.pos=t,this.fixed=n,this.pos0=i,this.vel=a,this.force=o,this.vs=[],this.es=[],this.fs=[],this.id=e.all.length,e.all.push(this)}));u.all=[];var v=Object(l.a)((function e(t,n,i,a,o,s){Object(h.a)(this,e),this.vs=[],this.lMax=n,this.maxContraction=i,this.edgeChannel=a,this.edgeActive=o,this.l=s;var r,l=Object(c.a)(t);try{for(l.s();!(r=l.n()).done;){var d=r.value;this.vs.push(u.all[d])}}catch(v){l.e(v)}finally{l.f()}u.all[t[0]].vs.push(u.all[t[1]]),u.all[t[1]].vs.push(u.all[t[0]]),u.all[t[0]].es.push(this),u.all[t[1]].es.push(this),this.id=e.all.length,e.all.push(this)}));v.all=[];var f=function(){function e(){Object(h.a)(this,e),this.viewer=null,this.Vertex=u,this.Edge=v,this.Model=e,this.controls=null,this.forceUpdate=null,this.sharedData=null,e.configure(),this.reset(),this.loadData(),this.resetSelection(),this.recordV()}return Object(l.a)(e,[{key:"reset",value:function(){this.v=[],this.e=[],this.v0=[],this.c=[],this.a0=[],this.fixedVs=[],this.lMax=[],this.edgeActive=[],this.edgeChannel=[],this.script=[],this.maxContraction=[],this.vel=[],this.f=[],this.l=[],this.vStatus=[],this.eStatus=[],this.fStatus=[],this.iAction=0,this.iActionPrev=0,this.numSteps=0,this.timeStart=new Date,this.editing=!1,this.simulate=!0,this.record=!1,e.gravity=!0,this.directional=!1,this.euler=new d.Euler(0,0,0),this.v_frames=[],this.numChannels=e.defaultNumChannels,this.numActions=e.defaultNumActions,this.inflateChannel=new Array(this.numChannels).fill(!1),this.contractionPercent=new Array(this.numChannels).fill(1)}},{key:"loadDict",value:function(e){console.log(e);for(var t,n,i,a,o,s,r=[],c=Array.from(e.e),l=[],h=[],u=0;u<e.v.length;u++)r.push(new d.Vector3(e.v[u][0],e.v[u][1],e.v[u][2]));this.reset(),e.lMax&&(t=e.lMax),e.maxContraction&&(n=e.maxContraction),e.fixedVs&&(i=e.fixedVs),e.edgeChannel&&(a=e.edgeChannel),e.edgeActive&&(o=e.edgeActive),e.script&&(s=e.script),e.numChannels&&(this.numChannels=e.numChannels),e.numActions&&(this.numActions=e.numActions),this.loadData(r,c,l,h,t,n,i,a,o,s),e.lMax||e.maxContraction||e.fixedVs||this.loadData(r,c,l,h)}},{key:"loadData",value:function(e,t,n,i){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,r=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null,c=arguments.length>8&&void 0!==arguments[8]?arguments[8]:null,l=arguments.length>9&&void 0!==arguments[9]?arguments[9]:[];e&&t?(this.v=e,this.e=t):(this.v.push(new d.Vector3(1,-1/Math.sqrt(3),.2)),this.v.push(new d.Vector3(0,2/Math.sqrt(3),.2)),this.v.push(new d.Vector3(-1,-1/Math.sqrt(3),.2)),this.v.push(new d.Vector3(0,0,4/Math.sqrt(6)+.2)),this.e.push([0,1]),this.e.push([1,2]),this.e.push([2,0]),this.e.push([0,3]),this.e.push([1,3]),this.e.push([2,3])),s&&(this.fixedVs=s),a&&(this.lMax=a),o&&(this.maxContraction=o),c&&(this.edgeActive=c),r&&(this.edgeChannel=r),l&&(this.script=l),this.updateCorners(),this.precompute(),this.initCheck(),this.resetSelection(),this.recordV()}},{key:"saveData",value:function(){var e,t={v:[]},n=Object(c.a)(this.v);try{for(n.s();!(e=n.n()).done;){var i=e.value;t.v.push([i.x,i.y,i.z])}}catch(d){n.e(d)}finally{n.f()}t.v0=[];var a,o=Object(c.a)(this.v0);try{for(o.s();!(a=o.n()).done;){var s=a.value;t.v0.push([s.x,s.y,s.z])}}catch(d){o.e(d)}finally{o.f()}t.e=[];for(var r=0;r<this.e.length;r++)t.e.push(this.e[r].slice());t.fixedVs=this.fixedVs.slice(),t.lMax=this.lMax.slice(),t.edgeChannel=this.edgeChannel.slice(),t.edgeActive=this.edgeActive.slice(),t.script=[];for(var l=0;l<this.script.length;l++){var h=this.script[l].slice();t.script.push(h)}return t.maxContraction=this.maxContraction.slice(),t.vStatus=this.vStatus.slice(),t.eStatus=this.eStatus.slice(),t.fStatus=this.fStatus.slice(),t.euler=this.euler.clone(),t.numChannels=this.numChannels,t.numActions=this.numActions,t.inflateChannel=this.inflateChannel.slice(),t.contractionPercent=this.contractionPercent.slice(),t.v_frames=this.v_frames,t}},{key:"sameData",value:function(e,t){var n=!0;return JSON.stringify(e.e)!==JSON.stringify(t.e)&&(n=!1),JSON.stringify(e.fixedVs)!==JSON.stringify(t.fixedVs)&&(n=!1),JSON.stringify(e.lMax)!==JSON.stringify(t.lMax)&&(n=!1),JSON.stringify(e.edgeChannel)!==JSON.stringify(t.edgeChannel)&&(n=!1),JSON.stringify(e.edgeActive)!==JSON.stringify(t.edgeActive)&&(n=!1),JSON.stringify(e.script)!==JSON.stringify(t.script)&&(n=!1),JSON.stringify(e.maxContraction)!==JSON.stringify(t.maxContraction)&&(n=!1),e.euler.x!==t.euler.x&&(n=!1),e.euler.y!==t.euler.y&&(n=!1),e.euler.z!==t.euler.z&&(n=!1),e.numChannels!==t.numChannels&&(n=!1),e.numActions!==t.numActions&&(n=!1),n}},{key:"recordHistory",value:function(){var t=this.saveData();-1!==this.Model.iHistory&&this.sameData(t,this.Model.history[this.Model.iHistory])||(console.log("record"),e.history=e.history.slice(0,e.iHistory+1),e.history.push(this.saveData()),e.history.length>50&&e.history.shift(),e.iHistory=e.history.length-1)}},{key:"applyHistory",value:function(t){if(-1!==t){var n=e.history[t],i=this.simulate,a=this.Model.gravity;this.loadDict(n),this.simulate=i,this.record=!1,this.Model.gravity=a,this.forceUpdate()}}},{key:"undo",value:function(){e.iHistory-1>=0&&(e.iHistory-=1),this.applyHistory(e.iHistory)}},{key:"redo",value:function(){e.iHistory+1<e.history.length&&(console.log(e.iHistory),e.iHistory+=1,console.log("yes"),console.log(e.iHistory)),this.applyHistory(e.iHistory)}},{key:"resetSelection",value:function(){this.vStatus=new Array(this.v.length).fill(0),this.eStatus=new Array(this.e.length).fill(0),this.fStatus=new Array(this.f.length).fill(0)}},{key:"recordV",value:function(){this.v0=[];var e,t=-this.bbox()[5],n=Object(c.a)(this.v);try{for(n.s();!(e=n.n()).done;){var i=e.value.clone();i.z+=t,this.v0.push(i)}}catch(a){n.e(a)}finally{n.f()}}},{key:"resetV",value:function(){this.iAction=0,this.numSteps=0;for(var e=0;e<this.v.length;e++)this.v[e].copy(this.v0[e]);this.numSteps=0}},{key:"precompute",value:function(){var t=this,n=function(e,t){for(var n=0;n<Math.min(e.length,t.length);n++)t[n]=e[n];return t};this.l=[];for(var i=0;i<this.e.length;i++){var a=this.e[i];this.l.push(this.v[a[0]].distanceTo(this.v[a[1]]))}if(this.vel.length!==this.v.length){this.vel=[];for(var o=0;o<this.v.length;o++)this.vel.push(new d.Vector3)}if(this.maxContraction.length!==this.e.length){var s=new Array(this.e.length).fill(e.maxMaxContraction);this.maxContraction=n(this.maxContraction,s)}if(this.fixedVs.length!==this.v.length){var r=new Array(this.v.length).fill(!1);this.fixedVs=n(this.fixedVs,r)}if(this.lMax.length!==this.e.length){var c=new Array(this.e.length).fill(e.defaultMaxLength);this.lMax=n(this.lMax,c)}if(this.edgeActive.length!==this.e.length){var l=new Array(this.e.length).fill(!0);this.edgeActive=n(this.edgeActive,l)}if(this.edgeChannel.length!==this.e.length){var h=new Array(this.e.length).fill(0);this.edgeChannel=n(this.edgeChannel,h)}if(this.script.length!==this.numChannels||this.script.length&&this.script[0].length!==this.numActions){var u=Array(this.numChannels).fill(!1).map((function(e){return Array(t.numActions).fill(!1)}));0===this.script.length&&(this.script=u);for(var v=0;v<Math.min(this.script.length,u.length);v++)for(var f=0;f<Math.min(this.script[0].length,u[0].length);f++)u[v][f]=this.script[v][f];this.script=u}}},{key:"initCheck",value:function(){for(var e=0;e<this.e.length;e++)this.edgeActive[e]&&this.lMax[e]!==this.Model.defaultMaxLength&&(console.log("An active beam is having wrong max length ".concat(this.lMax[e],".")),this.lMax[e]=this.Model.defaultMaxLength)}},{key:"updateCorners",value:function(){this.updateDataStructure(),this.c=[],this.a0=[];var t,n=Object(c.a)(u.all);try{for(n.s();!(t=n.n()).done;)for(var i=t.value.es,a=0;a<i.length-1;a++){var o=i[a],s=i[a+1],l=e.getAngle(o,s,!0),h=Object(r.a)(l,2),d=h[0],v=h[1];this.c.push(v),this.a0.push(d)}}catch(f){n.e(f)}finally{n.f()}}},{key:"checkCorners",value:function(){for(var t=0;t<this.c.length;t++){var n=Object(r.a)(this.c[t],3),i=n[0],a=n[1],o=n[2],s=this.v[a].clone().sub(this.v[i]),c=this.v[o].clone().sub(this.v[i]),l=s.angleTo(c);if(Math.abs(l-this.a0[t])>e.angleThreshold)return!1}return!0}},{key:"update",value:function(){this.f=[];for(var t=0;t<this.v.length;t++)this.f.push(new d.Vector3);for(var n=0;n<this.e.length;n++){var i=this.e[n],a=this.v[i[0]],o=this.v[i[1]].clone().sub(a),s=this.lMax[n];if(this.edgeActive[n]){var r=this.edgeChannel[n],c=s,l=c*(1-this.maxContraction[n]);s=c-this.contractionPercent[r]*(c-l)}var h=(o.length()-s)*e.k;h=o.normalize().multiplyScalar(h),this.f[i[0]].add(h),this.f[i[1]].add(h.negate())}for(var u=0;u<this.v.length;u++)e.gravity&&this.f[u].add(new d.Vector3(0,0,-e.gravityFactor*e.gravity))}},{key:"runScript",value:function(){if(0===this.script.length)return 0;if(this.numSteps>(this.iAction+1)%this.numActions*e.numStepsAction){this.iAction=Math.floor(this.numSteps/e.numStepsAction)%this.numActions,this.editing&&(this.iAction=0);for(var t=0;t<this.numChannels;t++)this.inflateChannel[t]=this.script[t][this.iAction]}}},{key:"step",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.recordFrames();for(var i=0;i<t;i++){if(this.precompute(),!this.simulate)return;n&&this.runScript(),this.editing;for(var a=0;a<this.inflateChannel.length;a++)this.inflateChannel[a]?(this.contractionPercent[a]-=e.contractionPercentRate,this.contractionPercent[a]<0&&(this.contractionPercent[a]=0)):(this.contractionPercent[a]+=e.contractionPercentRate,this.contractionPercent[a]>1&&(this.contractionPercent[a]=1));this.update();for(var o=0;o<this.v.length;o++)this.fixedVs[o]||this.sharedData.movingJoint&&!this.sharedData.movingBody&&2!==this.vStatus[o]||(this.vel[o].add(this.f[o].clone().multiplyScalar(e.h)),this.v[o].z<=0&&(e.directionalFriction?(this.vel[o].x,this.vel[o].x*=1-e.frictionFactor):this.vel[o].x*=1-e.frictionFactor,this.vel[o].y*=1-e.frictionFactor),this.vel[o].multiplyScalar(e.dampingRatio),this.vel[o].length()>5&&this.vel[o].multiplyScalar(Math.pow(.9,Math.ceil(Math.log(5/this.vel[o].length())/Math.log(.9)))),this.v[o].add(this.vel[o].clone().multiplyScalar(e.h)),this.v[o].z<=0&&(this.vel[o].z=-this.vel[o].z,this.v[o].z=0));this.numSteps,e.angleCheckFrequency,this.numSteps+=1}return this.v}},{key:"addJoint",value:function(t){var n=new d.Vector3;n.copy(this.v[t]);var i=new d.Vector3(e.defaultMinLength,0,0);n=n.add(i),this.v.push(n);var a=[t,this.v.length-1];this.e.push(a)}},{key:"addEdges",value:function(e){for(var t=0;t<e.length;t++)for(var n=t+1;n<e.length;n++){var i,a=!0,o=Object(c.a)(this.e);try{for(o.s();!(i=o.n()).done;){var s=i.value;if(s.includes(e[t])&&s.includes(e[n])){a=!1;break}}}catch(r){o.e(r)}finally{o.f()}a&&this.e.push([e[t],e[n]])}this.updateCorners()}},{key:"addTet",value:function(e){if(3===e.length){var t,n=e[0],i=e[1],a=e[2],o=this.v[n],s=this.v[i],r=this.v[a],l=0,h=[],u=Object(c.a)(this.e);try{for(u.s();!(t=u.n()).done;){var v=t.value,f=0,p=!1;v.includes(n)&&(p||(h.push(v),p=!0),f+=1),v.includes(i)&&(p||(h.push(v),p=!0),f+=1),v.includes(a)&&(p||(h.push(v),p=!0),f+=1),console.assert(f<=2),2===f&&(l+=1)}}catch(D){u.e(D)}finally{u.f()}if(console.assert(l<=3),3===l){var g,j={},b=Object(c.a)(h);try{for(b.s();!(g=b.n()).done;){var m=g.value;m[0]in j?j[m[0]]+=1:j[m[0]]=1,m[1]in j?j[m[1]]+=1:j[m[1]]=1}}catch(D){b.e(D)}finally{b.f()}var x=0,y=-1;for(var O in j)if(O=parseInt(O),![n,i,a].includes(O)){var C=j[O];3===C&&(y=O,x+=1),console.log("iv_mirror: ",y),console.assert(C<=3)}if(x>1)return void console.log("more than one tet connected.");if(-1!==y){var w=this.v[y],S=new d.Vector3;S.copy(w);var M=new d.Vector3,k=new d.Vector3;M.subVectors(s,o),k.subVectors(r,s);var A=M.cross(k).normalize();w.clone().sub(o).dot(A)<0&&A.negate();var P=w.clone().sub(o).dot(A),U=A.multiplyScalar(-2*P);S.add(U),this.v.push(S);var I=[n,this.v.length-1],V=[i,this.v.length-1],J=[a,this.v.length-1];this.e.push(I),this.e.push(V),this.e.push(J)}}else console.log("Points not in a triangle.")}}},{key:"removeJoint",value:function(t){if(![0,1,2,3].includes(t)){this.updateDataStructure();var n,i=[],a=u.all[t],o=Object(c.a)(a.es);try{for(o.s();!(n=o.n()).done;){var s=n.value;i.push(s)}}catch(r){o.e(r)}finally{o.f()}u.all=u.all.filter((function(e){return e!==a})),v.all=v.all.filter((function(e){return!i.includes(e)})),e.reindexObjects(u),e.reindexObjects(v),this.updateFromDataStructure(),this.updateCorners(),this.forceUpdate()}}},{key:"removeEdge",value:function(e){}},{key:"recordFrames",value:function(){if(!this.record)return 0;console.log("record");var e,t=[],n=Object(c.a)(this.v);try{for(n.s();!(e=n.n()).done;){var i=e.value;t.push([i.x,i.y,i.z])}}catch(a){n.e(a)}finally{n.f()}this.v_frames.push(t)}},{key:"resetRecording",value:function(){console.log("reset_recording"),this.v_frames=[]}},{key:"updateDataStructure",value:function(){u.all=[];for(var e=0;e<this.v.length;e++)new u(this.v[e],this.fixedVs[e],this.v0[e],this.vel[e],this.f[e]);v.all=[];for(var t=0;t<this.e.length;t++)new v(this.e[t],this.lMax[t],this.maxContraction[t],this.edgeChannel[t],this.edgeActive[t],this.l[t])}},{key:"updateFromDataStructure",value:function(){this.v=[],this.fixedVs=[],this.v0=[],this.vel=[],this.f=[];var e,t=Object(c.a)(u.all);try{for(t.s();!(e=t.n()).done;){var n=e.value;this.v.push(n.pos),this.fixedVs.push(n.fixed),this.v0.push(n.pos0),this.vel.push(n.vel),this.f.push(n.f)}}catch(r){t.e(r)}finally{t.f()}this.e=[],this.lMax=[],this.maxContraction=[],this.edgeChannel=[],this.edgeActive=[],this.l=[];var i,a=Object(c.a)(v.all);try{for(a.s();!(i=a.n()).done;){var o=i.value,s=[o.vs[0].id,o.vs[1].id];this.e.push(s),this.lMax.push(o.lMax),this.maxContraction.push(o.maxContraction),this.edgeChannel.push(o.edgeChannel),this.edgeActive.push(o.edgeActive),this.l.push(o.l)}}catch(r){a.e(r)}finally{a.f()}this.vStatus=new Array(this.v.length).fill(0),this.eStatus=new Array(this.e.length).fill(0)}},{key:"centroid",value:function(){var e,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],n=new d.Vector3(0,0,0),i=t?this.v0:this.v,a=Object(c.a)(i);try{for(a.s();!(e=a.n()).done;){var o=e.value;n.add(o)}}catch(s){a.e(s)}finally{a.f()}return n.divideScalar(this.v.length),n}},{key:"center",value:function(){for(var e=this.centroid(),t=this.bbox(),n=Object(r.a)(t,6),i=n[0],a=n[1],o=n[2],s=n[3],c=n[4],l=n[5],h=(Math.max([o-l,a-c,i-s]),0);h<this.v.length;h++)this.v[h].x-=e.x,this.v[h].y-=e.y,this.v[h].z-=l,this.v[h].z+=o-l;this.recordV()}},{key:"align",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];if(t.length>0){var n,i=new d.Vector3(0,0,0),a=Object(c.a)(t);try{for(a.s();!(n=a.n()).done;){var o=n.value,s=this.v[o];i.add(s)}}catch(u){a.e(u)}finally{a.f()}i.divideScalar(t.length);var r=this.centroid();i.sub(r);var l=i.clone();l.z=0;var h=Math.atan2(l.y,l.x);e||(h-=Math.PI/2),this.rotateTo(this.euler.x,this.euler.y,this.euler.z-h)}}},{key:"stepsPerSecond",value:function(){var e=new Date;return this.numSteps/((e.getTime()-this.timeStart.getTime())/1e3)}},{key:"bbox",value:function(){var e,t,n,i,a,o;e=t=n=-1/0,i=a=o=1/0;var s,r=Object(c.a)(this.v);try{for(r.s();!(s=r.n()).done;){var l=s.value;l.x>e&&(e=l.x),l.y>t&&(t=l.y),l.z>n&&(n=l.z),l.x<i&&(i=l.x),l.y<a&&(a=l.y),l.z<o&&(o=l.z)}}catch(h){r.e(h)}finally{r.f()}return[e,t,n,i,a,o]}},{key:"infoJoints",value:function(){return"joints: "+this.v.length}},{key:"infoBeams",value:function(){return"actuators: "+this.e.length}},{key:"fixJoints",value:function(e){for(var t=0;t<e.length;t++){e[t];alert("not implemented")}}},{key:"unfixAll",value:function(){this.fixedVs=[],this.fixedVs=new Array(this.v.length).fill(!1)}},{key:"rotateTo",value:function(e,t,n){var i=this.centroid(),a=new d.Euler;a.setFromVector3((new d.Vector3).setFromEuler(this.euler).negate(),"ZYX"),this.euler=new d.Euler(e,t,n);for(var o=0;o<this.v.length;o++)this.v[o].sub(i),this.v[o].applyEuler(a),this.v[o].applyEuler(this.euler),this.v[o].add(i);this.recordV()}}],[{key:"configure",value:function(){!function(t){var n=new XMLHttpRequest;n.open("GET",t,!1),n.onreadystatechange=function(){4===n.readyState&&(200!==n.status&&0!==n.status||function(t){var n=JSON.parse(t);e.k=n.k,e.h=n.h,e.dampingRatio=n.dampingRatio,e.contractionInterval=n.contractionInterval,e.contractionLevels=n.contractionLevels,e.maxMaxContraction=Math.round(e.contractionInterval*(e.contractionLevels-1)*100)/100,e.contractionPercentRate=n.contractionPercentRate,e.gravityFactor=n.gravityFactor,e.gravity=Boolean(n.gravity),e.defaultMinLength=n.defaultMinLength,e.defaultMaxLength=e.defaultMinLength/(1-e.maxMaxContraction),e.frictionFactor=n.frictionFactor,e.directionalFriction=n.directionalFriction,e.numStepsAction=n.numStepsActionMultiplier/e.h,e.defaultNumActions=n.defaultNumActions,e.defaultNumChannels=n.defaultNumChannels,e.angleThreshold=n.angleThreshold,e.angleCheckFrequency=e.numStepsAction*n.angleCheckFrequencyMultiplier}(n.responseText))},n.send(null)}("config.json")}},{key:"getAngle",value:function(e,t){var n,i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],a=e.vs,o=t.vs;a[0]===o[0]?n=[a[0],a[1],o[1]]:a[0]===o[1]?n=[a[0],a[1],o[0]]:a[1]===o[0]?n=[a[1],a[0],o[1]]:a[1]===o[1]?n=[a[1],a[0],o[0]]:console.error("edges not intersected");var s=n[0].pos.clone(),r=n[1].pos.clone(),c=n[2].pos.clone();return r.sub(s),c.sub(s),i?[r.angleTo(c),[n[0].id,n[1].id,n[2].id]]:r.angleTo(c)}}]),e}();f.history=[],f.iHistory=-1,f.reindexObjects=function(e){var t,n=0,i=Object(c.a)(e.all);try{for(i.s();!(t=i.n()).done;){t.value.id=n,n+=1}}catch(a){i.e(a)}finally{i.f()}};n.p,n(49);var p=n(20),g=n(134),j=n(135),b=n(0),m=new d.Color(.6,.6,.6),x=[new d.Color(.1,.3,.6),new d.Color(.5,.4,.1),new d.Color(.5,.1,.5),new d.Color(.1,.5,.2),new d.Color(.6,.2,.4),new d.Color(.2,.6,.4),new d.Color(.4,.6,.2),new d.Color(.6,.6,.2),new d.Color(.2,.6,.6)],y=(new d.Color(1,1,1),new d.Color(.9,.9,.9)),O=new d.Color(.05,.05,.05),C=new d.Color(.9,0,0),w=new d.Color(.9,.05,0),S=new d.Color(.2,.6,.6),M=new d.Color(.15,.15,.15),k=.026,A=.06,P=!1;function U(e){var t=e.v,n=e.d,a=e.iv,o=e.c,s=e.model,c=e.handleClick,l=e.handlePointerOver,h=e.handlePointerOut,u=e.setOControls,v=e.translating,f=Object(i.useRef)(),j=Object(i.useRef)(),m=Object(i.useRef)(),x=Object(i.useState)(!1),y=Object(r.a)(x,2),O=(y[0],y[1],new d.Vector3,!1);return Object(p.b)((function(e){null!==f.current&&(j.current.color.copy(o),v?(f.current.position.multiplyScalar(0),O?(s.v[a].copy(m.current.object.position),u(!1),s.simulate=!0):(m.current.object.position.copy(s.v[a]),u(!0))):(m.current.object.position.copy(s.v[a]),f.current.position.multiplyScalar(0)))})),Object(i.useEffect)((function(){var e=function(e){u(!e.value),O=e.value};if(m.current){var t=m.current;return window.tran=t,t.addEventListener("dragging-changed",e),function(){t.removeEventListener("dragging-changed",e)}}})),Object(b.jsx)(g.a,{ref:m,enabled:v,showX:v,showY:v,showZ:v,mode:"translate",space:"local",children:Object(b.jsxs)("mesh",{ref:f,position:t,castShadow:!0,scale:[n,n,n],onClick:c,onPointerOver:l,onPointerOut:h,children:[Object(b.jsx)("sphereBufferGeometry",{args:[1,20,20]}),Object(b.jsx)("meshLambertMaterial",{ref:j,color:o})]})})}function I(e){var t=e.v,n=e.iv,a=e.model,o=e.setOControls,s=e.sharedData,c=(a.vStatus[n],a.vStatus[n],Object(i.useState)(!1)),l=Object(r.a)(c,2),h=l[0],u=l[1],v=new d.Color;Object(p.b)((function(e){var t=2===a.vStatus[n],i=1===a.vStatus[n],o=a.fixedVs[n];v.copy(t?C:i?w:o?S:m),s.movingJoint&&2===a.vStatus[n]&&!h&&u(!0),s.movingJoint&&2===a.vStatus[n]||!h||u(!1)}));return Object(b.jsx)(U,{v:t,d:A,iv:n,model:a,handleClick:function(e){s.removingJoint?(a.removeJoint(n),a.precompute(),a.recordV(),a.forceUpdate()):s.addingJoint?(a.addJoint(n),a.precompute(),a.recordV(),a.forceUpdate()):s.movingJoint?(a.vStatus.fill(0),a.vStatus[n]=2):a.vStatus[n]=2,s.updateGUI(),e.stopPropagation()},handlePointerOver:function(e){2!==a.vStatus[n]&&(a.vStatus[n]=1),e.stopPropagation()},handlePointerOut:function(e){2!==a.vStatus[n]&&(a.vStatus[n]=0),e.stopPropagation()},setOControls:o,translating:h,c:v},"ball")}function V(e){var t=e.v0,n=e.v1,a=e.d,o=e.c,s=(e.opacity,e.transparent,e.handleClick),c=e.handlePointerOver,l=e.handlePointerOut,h=Object(i.useRef)(),u=Object(i.useRef)(),v=function(e,t){var n=e.clone().add(t).divideScalar(2),i=t.clone().sub(e),a=new d.Vector3(0,1,0),o=i.length();i.normalize();var s=(new d.Quaternion).setFromUnitVectors(a,i);return[n,o,(new d.Euler).setFromQuaternion(s)]},f=v(t,n),g=Object(r.a)(f,3),j=g[0],m=g[1],x=g[2];return Object(p.b)((function(e){if(null!==h.current){var i=v(t,n),a=Object(r.a)(i,3),s=a[0],c=a[1],l=a[2];h.current.position.copy(s),h.current.rotation.copy(l),h.current.scale[1]=c,u.current.color.copy(o)}})),Object(b.jsxs)("mesh",{ref:h,position:[j.x,j.y,j.z],rotation:x,castShadow:!0,scale:[a,m,a],onClick:s,onPointerOver:c,onPointerOut:l,children:[Object(b.jsx)("cylinderBufferGeometry",{args:[1,1,1,20]}),Object(b.jsx)("meshLambertMaterial",{ref:u,color:o})]})}function J(e){var t=e.v0,n=e.v1,i=e.ie,a=e.model,o=e.sharedData,s=n.clone().sub(t);s.length();s.normalize();var r=s.clone().multiplyScalar(.527),c=s.clone().multiplyScalar(.33),l=s.clone().multiplyScalar(.04),h=c.clone().add(t),u=h.clone().add(r),v=n.clone().sub(c),f=v.clone().sub(r),g=t.clone(),j=t.clone().add(c),y=n.clone(),S=n.clone().sub(c),A=v.clone().sub(s.clone().multiplyScalar(a.lMax[i]*(a.Model.maxMaxContraction-a.maxContraction[i]))),U=A.clone().add(l),I=new d.Color,J=new d.Color,D=new d.Color,G=new d.Color,L=new d.Color,z=function(){var e=x[a.edgeChannel[i]];if(o.showChannel){var t=2===a.eStatus[i],n=1===a.eStatus[i];I.copy(t?C:n?w:e),J.copy(t?C:n?w:e),D.copy(t?C:n?w:e),G.copy(t?C:n?w:e)}else{var s=2===a.eStatus[i],r=1===a.eStatus[i];I.copy(s?C:r?w:O),J.copy(s?C:r?w:m),D.copy(s?C:r?w:m),G.copy(s?C:r?w:M),L.copy(e)}L.copy(e)};try{z()}catch(R){console.log("error: changeColor")}Object(p.b)((function(e){var o=n.clone().sub(t);o.length();o.normalize();var s=o.clone().multiplyScalar(.527),r=o.clone().multiplyScalar(.33),c=o.clone().multiplyScalar(.04);h.copy(r.clone().add(t)),u.copy(h.clone().add(s)),v.copy(n.clone().sub(r)),f.copy(v.clone().sub(s)),g.copy(t.clone()),j.copy(t.clone().add(r)),y.copy(n.clone()),S.copy(n.clone().sub(r)),A.copy(v.clone().sub(o.clone().multiplyScalar(a.lMax[i]*(a.Model.maxMaxContraction-a.maxContraction[i])))),U.copy(A.clone().add(c));try{z()}catch(R){console.log("error: changeColor")}}));var N=function(e){a.eStatus[i]=2,e.stopPropagation()},T=function(e){for(2!==a.eStatus[i]&&(a.eStatus[i]=1),e.stopPropagation(),o.showInfo&&(o.infoPanel.style.display="block"),o.infoPanel.style.left=String(e.clientX)+"px",o.infoPanel.style.top=String(e.clientY)+"px";o.infoPanel.firstChild;)o.infoPanel.removeChild(o.infoPanel.firstChild);o.infoPanel.appendChild(o.infoPanel.ownerDocument.createTextNode("L: "+String(Math.round(1e3*a.l[i])/1e3/1.2*93)+"mm")),o.infoPanel.appendChild(o.infoPanel.ownerDocument.createElement("br")),o.infoPanel.appendChild(o.infoPanel.ownerDocument.createTextNode("S: "+String(Math.round(1e3*a.l[i])/1e3/1.2*62)+"mm"))},F=function(e){2!==a.eStatus[i]&&(a.eStatus[i]=0),e.stopPropagation(),o.infoPanel.style.display="none"},E=P,H=[Object(b.jsx)(V,{v0:h,v1:u,d:.065,c:I,opacity:1,transparent:E,handleClick:N,handlePointerOver:T,handlePointerOut:F},"out"),Object(b.jsx)(V,{v0:v,v1:f,d:.05,c:J,opacity:1,transparent:E,handleClick:N,handlePointerOver:T,handlePointerOut:F},"in"),Object(b.jsx)(V,{v0:g,v1:j,d:k,c:D,opacity:1,transparent:E,handleClick:N,handlePointerOver:T,handlePointerOut:F},"joint0"),Object(b.jsx)(V,{v0:S,v1:y,d:k,c:D,opacity:1,transparent:E,handleClick:N,handlePointerOver:T,handlePointerOut:F},"joint1")];return a.maxContraction[i]!==a.Model.maxMaxContraction&&H.push(Object(b.jsx)(V,{v0:A,v1:U,d:.06,c:O},"constraint")),a.edgeActive[i]?H:[Object(b.jsx)(V,{v0:t,v1:n,d:k,c:G,opacity:1,transparent:!1,handleClick:N,handlePointerOver:T,handlePointerOut:F},"beam")]}function D(e){var t=e.model,n=e.sharedData,i=e.setOControls,o=a.a.useState(new d.Clock),s=Object(r.a)(o,1)[0];Object(p.b)((function(e){var i=1e3/30-s.getDelta();setTimeout((function(){e.ready=!0,e.invalidate()}),Math.max(0,i)),e.ready=!1;t.Model.h;t.step(Math.floor(1.5/t.Model.h/30)),t.iAction!==t.iActionPrev&&(n.updateGUI(),t.iActionPrev=t.iAction)}),0);var l,h=[],u=[],v=Object(c.a)(t.v.entries());try{for(v.s();!(l=v.n()).done;){var f=Object(r.a)(l.value,2),g=f[0],j=f[1];h.push(Object(b.jsx)(I,{v:j,iv:g,model:t,setOControls:i,sharedData:n},"J"+String(g)))}}catch(M){v.e(M)}finally{v.f()}var m,x=Object(c.a)(t.e.entries());try{for(x.s();!(m=x.n()).done;){var y=Object(r.a)(m.value,2),O=y[0],C=y[1],w=t.v[C[0]],S=t.v[C[1]];u.push(Object(b.jsx)(J,{v0:w,v1:S,ie:O,model:t,sharedData:n,selected:C.selected,hovered:C.hovered},"B"+String(O)))}}catch(M){x.e(M)}finally{x.f()}return[].concat(h,u)}function G(){var e=new d.DirectionalLight(new d.Color(1,1,1),1);e.position.set(0,0,100),e.target.position.set(0,0,-100),e.castShadow=!0;return e.shadow.mapSize.width=2e3,e.shadow.mapSize.height=2e3,e.shadow.camera.top=-300,e.shadow.camera.right=300,e.shadow.camera.left=-300,e.shadow.camera.bottom=300,Object(b.jsx)("primitive",{object:e})}window.fps=30;var L=function(e){var t=e.oControls,n=Object(p.c)(),i=n.camera,a=n.gl.domElement;return Object(p.b)((function(){return t.current.update()})),Object(b.jsx)(j.a,{enableDamping:!1,ref:t,args:[i,a]})};var z=function(e){var t=e.model,n=e.sharedData,a=Object(i.useRef)();t.controls=a;var o=Object(i.useReducer)((function(e){return e+1}),0),s=Object(r.a)(o,2)[1];return t.forceUpdate=s,window.updateModel=s,t.recordHistory(),Object(b.jsxs)(p.a,{shadowMap:!0,concurrent:!0,onCreated:function(e){var t=e.gl;e.camera;t.setClearColor(new d.Color(1,1,1)),t.setPixelRatio(window.devicePixelRatio),t.shadowMap.enabled=!0,t.shadowMap.type=d.PCFSoftShadowMap},camera:{fov:45,position:[0,-20,1],up:[0,0,1]},gl:{antialias:!0},children:[Object(b.jsx)(L,{oControls:a}),Object(b.jsx)("ambientLight",{color:new d.Color(1,1,1),intensity:.5}),Object(b.jsx)(G,{}),Object(b.jsxs)("mesh",{position:[0,0,-.03],receiveShadow:!0,visible:!0,children:[Object(b.jsx)("planeGeometry",{args:[1e4,1e4]}),Object(b.jsx)("shadowMaterial",{opacity:.4,transparent:!0})]}),Object(b.jsxs)("mesh",{position:[0,0,-.04],receiveShadow:!0,visible:!0,children:[Object(b.jsx)("planeGeometry",{args:[1e4,1e4]}),Object(b.jsx)("meshLambertMaterial",{opacity:.5,color:y,transparent:!0,side:d.DoubleSide})]}),Object(b.jsx)("gridHelper",{args:[30,30],"rotation-x":-Math.PI/2,"position-z":0,visible:!0}),Object(b.jsx)(D,{model:t,sharedData:n,setOControls:function(e){a.current.enabled=e}})]})},N=n(15),T=n(96),F=n(98),E=n(99),H=n(136),R=n(102),B=n(132),K=n(107),_=n(108),q=n(111),X=n(47),Z=n(133),Y=n(100),Q=n(101),W=n(103),$=n(104),ee=n(105),te=n(106),ne=n(109),ie=n(110),ae=n(112),oe=n(113),se=n(114),re=n(115),ce=n(116),le=n(117),he=n(118),de=n(119),ue=n(120),ve=n(121),fe=n(122),pe=n(123),ge=n(124),je="rgba(200, 200, 200, 0.6)",be="rgba(200, 200, 200, 0.0)",me="rgba(250, 100, 50, 0.9)",xe=["rgb(100, 150, 220)","rgb(240, 240, 20)","rgb(200, 100, 200)","rgb(100, 200, 130)","rgb(200, 100, 100)","rgb(200, 100, 100)","rgb(200, 100, 100)","rgb(200, 100, 100)","rgb(200, 100, 100)","rgb(200, 100, 100)","rgb(200, 100, 100)","rgb(200, 100, 100)","rgb(200, 100, 100)","rgb(200, 100, 100)","rgb(200, 100, 100)"],ye=.5,Oe=.1,Ce=Object(T.a)((function(e){return{mainGUI:{position:"absolute",right:"1.5vh",top:"1.5vh",width:"28vh",height:"auto",background:je,"& .MuiList-root":{"& .MuiListItem-root":{minHeight:"6vh"}}},editingGUI:{position:"absolute",right:"30vh",top:"1.5vh",width:"30vh",background:je},scriptGUI:{position:"absolute",left:"2vh",bottom:"2vh",background:je},editingScriptGUI:{position:"absolute",right:"30vh",top:"44vh",width:"30vh",background:je},help:{position:"absolute",cursor:"pointer",right:"10px",bottom:"10px",width:"40px",height:"40px",alignContent:"center",background:je},examples:{position:"absolute",width:"130px",right:"60px",bottom:"10px",height:"40px",background:je,cursor:"pointer"}}}));function we(e){var t=e.model,n=e.updateGUI,i=[];Object(N.a)(Array(t.e.length).keys()).every((function(e){return 2!==t.eStatus[e]||2===t.eStatus[e]&&!0===t.edgeActive[e]})),Object(N.a)(Array(t.e.length).keys()).every((function(e){return 2!==t.eStatus[e]||2===t.eStatus[e]&&!1===t.edgeActive[e]}));return i.push(Object(b.jsx)(F.a,{item:!0,style:{width:"50%",textAlign:"center"},children:Object(b.jsx)(E.a,{size:"small",onClick:function(){for(var e=0;e<t.e.length;e++)2===t.eStatus[e]&&(t.edgeActive[e]=!0,t.lMax[e]=t.Model.defaultMaxLength);n(),setTimeout(t.forceUpdate,50)},children:Object(b.jsx)(Y.a,{})})},"active")),i.push(Object(b.jsx)(F.a,{item:!0,style:{width:"50%",textAlign:"center"},children:Object(b.jsx)(E.a,{size:"small",onClick:function(){for(var e=0;e<t.e.length;e++)2===t.eStatus[e]&&(t.edgeActive[e]=!1);n(),setTimeout(t.forceUpdate,50)},children:Object(b.jsx)(Q.a,{})})},"passive")),Object(b.jsxs)(H.a,{children:[Object(b.jsx)(R.a,{style:{width:"50%"},children:"Active / Passive"}),Object(b.jsx)(F.a,{container:!0,style:{width:"50%"},children:i})]})}function Se(e){for(var t=e.n,n=e.model,i=e.updateGUI,a=[],o=function(e){var o=!Object(N.a)(Array(n.e.length).keys()).every((function(t){return 2!==n.eStatus[t]||2===n.eStatus[t]&&n.edgeChannel[t]!==e})),s=xe[e];a.push(Object(b.jsx)(F.a,{item:!0,style:{width:"".concat(1/t*100,"%"),textAlign:"center"},children:Object(b.jsx)(E.a,{size:"small",onClick:function(){for(var t=0;t<n.e.length;t++)2===n.eStatus[t]&&(n.edgeChannel[t]=e);i()},children:o?Object(b.jsx)(W.a,{style:{color:s}}):Object(b.jsx)($.a,{style:{color:s}})})},e))},s=0;s<t;s++)o(s);return Object(b.jsx)(H.a,{children:Object(b.jsx)(F.a,{container:!0,styles:{width:"50%"},children:a})})}var Me=function(){var e=Object(i.useState)(!1),t=Object(r.a)(e,2),n=t[0],a=t[1];return Object(b.jsxs)(F.a,{container:!0,style:{height:"39px",border:"3px solid ".concat(n?me:be)},onPointerOver:function(){a(!0)},onPointerOut:function(){a(!1)},onClick:function(){window.open("https://jianzhe.notion.site/Web-PneuMesh-Examples-23cc48c3172849cc95b53ba68cc9d251","_blank").focus()},children:[Object(b.jsx)(F.a,{container:!0,xs:4,alignItems:"center",children:Object(b.jsx)(ee.a,{style:{height:"30px",width:"30px"}})}),Object(b.jsx)(F.a,{container:!0,xs:8,alignItems:"center",children:Object(b.jsx)("div",{children:"Examples"})})]})},ke=function(){var e=Object(i.useState)(!1),t=Object(r.a)(e,2),n=t[0],a=t[1];return Object(b.jsx)(F.a,{style:{height:"30px",width:"30px",border:"3px solid ".concat(n?me:be),padding:"2px"},onPointerOver:function(){a(!0)},onPointerOut:function(){a(!1)},onClick:function(){window.open("https://jianzhe.notion.site/Web-PneuMesh-Tutorial-e1182476d3d34b85b9619df3419c7c40","_blank").focus()},children:Object(b.jsx)(te.a,{style:{height:"30px",width:"30px"}})})};function Ae(e){var t=e.model,n=(e.sharedData,e.updateGUI,e.classes);t.precompute();for(var a=6*t.numActions+1,o=function(e){var t=e.model,a=e.iChannel,o=e.iAction,s=Object(i.useState)(!1),c=Object(r.a)(s,2),l=c[0],h=c[1],d=t.script[a][o],u=Object(i.useState)(o===t.iAction),v=Object(r.a)(u,2);v[0],v[1];return Object(b.jsx)(F.a,{item:!0,className:n.scriptBlock,style:{cursor:"pointer",background:xe[a],width:"".concat(5,"vh"),height:"".concat(5,"vh"),padding:"".concat(1,"vh"),margin:"".concat(.5,"vh"),border:"".concat(l?"4px":"2px"," solid ").concat(t.iAction===o?me:"rgba(250, 250, 250, 0.9)"),opacity:"".concat(d?1:l?.8:.1)},onPointerOver:function(){h(!0)},onPointerOut:function(){h(!1)},onClick:function(){t.script[a][o]=!d}},o)},s=function(e){for(var t=e.model,n=e.iChannel,i=[],a=0;a<t.numActions;a++){i.push(Object(b.jsx)(o,{model:t,isOn:!0,iChannel:n,iAction:a},a))}return Object(b.jsx)(F.a,{container:!0,item:!0,spacing:0,children:i})},c=[],l=0;l<t.numChannels;l++)c.push(Object(b.jsx)(s,{iChannel:l,model:t},l));return[Object(b.jsx)(F.a,{container:!0,item:!0,spacing:0,style:{padding:"".concat(ye,"vh"),width:"".concat(a,"vh")},children:c},"buttons")]}var Pe=function(e){var t=e.model,n=(e.options,e.sharedData),a=Object(i.useReducer)((function(e){return e+1}),0),o=Object(r.a)(a,2)[1];n.updateGUI=o,window.updateGUI=o,t.recordHistory();var s=Ce();return[Object(b.jsx)("div",{className:s.mainGUI,onPointerOver:function(e){n.GUIHovered=!0},onPointerOut:function(e){n.GUIHovered=!1},children:Object(b.jsxs)(K.a,{children:[Object(b.jsxs)(H.a,{button:!0,onClick:function(e){t.recordV();var n=t.saveData(),i=JSON.stringify(n),a=document.createElement("a");document.body.appendChild(a),a.download="download.json",a.style.display="none",a.href="data:text/plain;charset=utf-8,"+encodeURIComponent(i),a.click(),document.body.removeChild(a)},children:[Object(b.jsx)(_.a,{children:Object(b.jsx)(ne.a,{})}),Object(b.jsx)(R.a,{children:"Download"})]}),Object(b.jsxs)(H.a,{button:!0,selected:!1,onClick:function(e){var n=document.createElement("input");document.body.appendChild(n),n.type="file",n.id="inputFile",n.style="display:none",document.getElementById("inputFile").click(),document.getElementById("inputFile").onchange=function(){var e=new FileReader;e.onload=function(e){var n=e.target.result;window.inputFileString=n;var i=JSON.parse(n);window.data=i,t.loadDict(i),t.simulate=!1,t.Model.gravity=!0,t.forceUpdate(),o()},e.readAsText(document.getElementById("inputFile").files[0]),document.body.removeChild(n)}},children:[Object(b.jsx)(_.a,{children:Object(b.jsx)(ie.a,{})}),Object(b.jsx)(R.a,{children:"Load"})]}),Object(b.jsx)(q.a,{}),Object(b.jsx)(q.a,{}),Object(b.jsxs)(H.a,{button:!0,selected:t.editing,onClick:function(e){if(t.editing=!t.editing,t.editing){n.editingScript=!1,t.simulate=!1,t.Model.gravity=!1,n.movingJoint=!1,n.removingJoint=!1,n.addingJoint=!1,t.center();for(var i=0;i<t.v.length;i++)t.vel*=0}t.editing||(n.movingJoint=!1,n.removingJoint=!1,n.addingJoint=!1,t.Model.gravity=!0,t.simulate=!0),t.controls.current.target=t.centroid(),o(),t.forceUpdate()},children:[Object(b.jsx)(_.a,{children:Object(b.jsx)(ae.a,{})}),Object(b.jsx)(R.a,{children:"Edit Shape (E)"})]}),Object(b.jsxs)(H.a,{children:[Object(b.jsx)(_.a,{children:Object(b.jsx)(oe.a,{})}),Object(b.jsx)(R.a,{style:{left:"2px"},children:"ChannelColor"}),Object(b.jsx)(B.a,{i:1,checked:n.showChannel,onChange:function(e){n.showChannel=!n.showChannel,o()}})]}),Object(b.jsx)(Se,{n:t.numChannels,model:t,updateGUI:o}),Object(b.jsxs)(H.a,{children:[Object(b.jsx)(X.a,{style:{width:"50%"},children:"Contraction"}),Object(b.jsx)(Z.a,{style:{width:"50%"},disabled:!t.eStatus.includes(2)||!Object(N.a)(Array(t.e.length).keys()).every((function(e){return 2===t.eStatus[e]&&t.edgeActive[e]||2!==t.eStatus[e]})),defaultValue:t.Model.maxMaxContraction,"aria-labelledby":"discrete-slider-custom",step:t.Model.contractionInterval,min:0,max:t.Model.maxMaxContraction,valueLabelDisplay:"auto",onChange:function(e,n){for(var i=0;i<t.e.length;i++)2===t.eStatus[i]&&(t.maxContraction[i]=n)},onPointerUp:function(){t.forceUpdate()}})]}),Object(b.jsxs)(H.a,{children:[Object(b.jsx)(R.a,{style:{width:"50%"},children:"Fix Joints (F/U)"}),Object(b.jsxs)(F.a,{container:!0,style:{width:"50%"},spacing:0,alignItems:"center",children:[Object(b.jsx)(F.a,{item:!0,style:{width:"50%",textAlign:"center"},children:Object(b.jsx)(E.a,{size:"small",onClick:function(e){for(var n=0;n<t.v.length;n++)2===t.vStatus[n]&&(t.fixedVs[n]=!0);o(),t.forceUpdate()},children:Object(b.jsx)(se.a,{})})},"fix"),Object(b.jsx)(F.a,{item:!0,style:{width:"50%",textAlign:"center"},children:Object(b.jsx)(E.a,{size:"small",onClick:function(e){for(var n=0;n<t.v.length;n++)2===t.vStatus[n]&&(t.fixedVs[n]=!1);o(),t.forceUpdate()},children:Object(b.jsx)(re.a,{})})},"unfix")]})]}),Object(b.jsx)(q.a,{}),Object(b.jsx)(we,{model:t,updateGUI:o}),Object(b.jsxs)(H.a,{children:[Object(b.jsx)(X.a,{style:{width:"50%"},children:"Length"}),Object(b.jsx)(Z.a,{style:{width:"50%"},disabled:!t.eStatus.includes(2)||!Object(N.a)(Array(t.e.length).keys()).every((function(e){return 2===t.eStatus[e]&&!t.edgeActive[e]||2!==t.eStatus[e]})),defaultValue:t.Model.defaultMinLength,"aria-labelledby":"discrete-slider-custom",step:t.Model.contractionInterval*t.Model.defaultMaxLength,min:t.Model.defaultMinLength,max:t.Model.defaultMaxLength,valueLabelDisplay:"auto",onChange:function(e,n){for(var i=0;i<t.e.length;i++)2===t.eStatus[i]&&!1===t.edgeActive[i]&&(t.lMax[i]=n);t.forceUpdate()},onPointerUp:function(){t.forceUpdate()}})]}),Object(b.jsx)(q.a,{}),Object(b.jsx)(q.a,{}),Object(b.jsxs)(H.a,{children:[Object(b.jsx)(_.a,{children:Object(b.jsx)(ce.a,{})}),Object(b.jsx)(R.a,{children:"Gravity"}),Object(b.jsx)(B.a,{i:0,checked:t.Model.gravity,onChange:function(e){t.Model.gravity=!t.Model.gravity,o()}})]}),Object(b.jsxs)(H.a,{children:[Object(b.jsx)(_.a,{children:Object(b.jsx)(le.a,{})}),Object(b.jsx)(R.a,{children:"Simulate"}),Object(b.jsx)(B.a,{i:0,checked:t.simulate,onChange:function(e){t.simulate=!t.simulate,t.simulate||(t.record=!1),o()}})]}),Object(b.jsxs)(H.a,{children:[Object(b.jsx)(_.a,{children:Object(b.jsx)(le.a,{})}),Object(b.jsx)(R.a,{children:"Record"}),Object(b.jsx)(B.a,{i:0,checked:t.record,onChange:function(e){t.record=!t.record,t.record&&(t.simulate=!0,t.resetRecording()),o()}})]}),Object(b.jsxs)(H.a,{children:[Object(b.jsx)(X.a,{style:{width:"50%"},children:"# of Actions"}),Object(b.jsx)(Z.a,{style:{width:"50%"},defaultValue:t.Model.defaultNumActions,"aria-labelledby":"discrete-slider-custom",step:1,min:1,max:20,valueLabelDisplay:"auto",onChange:function(e,n){t.numActions=n,t.precompute(),o()}},"numActions")]}),Object(b.jsx)(q.a,{}),Object(b.jsx)(q.a,{}),Object(b.jsxs)(H.a,{button:!0,onClick:function(e){t.controls.current.target=t.centroid(),t.forceUpdate()},children:[Object(b.jsx)(_.a,{children:Object(b.jsx)(he.a,{})}),Object(b.jsx)(R.a,{children:"Look At Center"})]})]})},"mainGUI"),Object(b.jsx)("div",{className:s.editingGUI,style:t.editing?{display:"block"}:{display:"none"},onPointerOver:function(e){n.GUIHovered=!0},onPointerOut:function(e){n.GUIHovered=!1},children:Object(b.jsxs)(K.a,{children:[Object(b.jsxs)(H.a,{button:!0,onClick:function(e){for(var n=[],i=0;i<t.v.length;i++)2===t.vStatus[i]&&n.push(i);1===n.length&&(t.addJoint(n[0]),t.precompute(),t.recordV(),t.forceUpdate(),t.resetSelection(),o())},children:[Object(b.jsx)(_.a,{children:Object(b.jsx)(de.a,{})}),Object(b.jsx)(R.a,{children:"Add Joint (A)"})]}),Object(b.jsxs)(H.a,{button:!0,onClick:function(e){for(var n=[],i=0;i<t.v.length;i++)2===t.vStatus[i]&&n.push(i);t.addEdges(n),t.precompute(),t.forceUpdate(),t.resetSelection(),o()},children:[Object(b.jsx)(_.a,{children:Object(b.jsx)(ue.a,{})}),Object(b.jsx)(R.a,{children:"Connect Joints (C)"})]}),Object(b.jsxs)(H.a,{button:!0,onClick:function(e){for(var n=[],i=0;i<t.v.length;i++)2===t.vStatus[i]&&n.push(i);t.addTet(n),t.precompute(),t.forceUpdate(),t.resetSelection(),o()},children:[Object(b.jsx)(_.a,{children:Object(b.jsx)(ve.a,{})}),Object(b.jsx)(R.a,{children:"Add Tet (T)"})]}),Object(b.jsxs)(H.a,{button:!0,onClick:function(e){for(var n=[],i=0;i<t.v.length;i++)2===t.vStatus[i]&&n.push(i);1===n.length&&(t.removeJoint(n[0]),t.precompute(),t.recordV(),t.forceUpdate(),t.resetSelection(),o())},children:[Object(b.jsx)(_.a,{children:Object(b.jsx)(fe.a,{})}),Object(b.jsx)(R.a,{children:"Remove Joint (D)"})]}),Object(b.jsxs)(H.a,{children:[Object(b.jsx)(_.a,{children:Object(b.jsx)(pe.a,{})}),Object(b.jsx)(R.a,{children:"Move Joint (M)"}),Object(b.jsx)(B.a,{checked:n.movingJoint,onChange:function(e,i){n.movingJoint=i,i&&(n.removingJoint=!1,n.addingJoint=!1),t.simulate=!1,t.resetSelection(),o()}},"add_joint")]}),Object(b.jsxs)(H.a,{children:[Object(b.jsx)(R.a,{children:"\xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 Move Body"}),Object(b.jsx)(B.a,{disabled:!n.movingJoint,checked:n.movingBody,onChange:function(e,t){n.movingBody=t,o()}},"add_joint")]}),Object(b.jsx)(q.a,{}),Object(b.jsxs)(H.a,{children:[Object(b.jsx)(R.a,{children:"X:"}),Object(b.jsx)(Z.a,{defaultValue:0,"arial-labelledby":"continuous-slider",step:.01,min:-Math.PI,max:Math.PI,valueLabelDisplay:"auto",onMouseDown:function(e){},onMouseUp:function(e){},onChange:function(e,n){t.rotateTo(n,t.euler.y,t.euler.z)}},"sliderX")]}),Object(b.jsxs)(H.a,{children:[Object(b.jsx)(R.a,{children:"Y:"}),Object(b.jsx)(Z.a,{defaultValue:0,"arial-labelledby":"continuous-slider",step:.01,min:-Math.PI,max:Math.PI,valueLabelDisplay:"auto",onMouseDown:function(e){},onMouseUp:function(e){},onChange:function(e,n){t.rotateTo(t.euler.x,n,t.euler.z)}},"sliderY")]}),Object(b.jsxs)(H.a,{children:[Object(b.jsx)(R.a,{children:"Z:"}),Object(b.jsx)(Z.a,{defaultValue:0,"arial-labelledby":"continuous-slider",step:.01,min:-Math.PI,max:Math.PI,valueLabelDisplay:"auto",onMouseDown:function(e){},onMouseUp:function(e){},onChange:function(e,n){t.rotateTo(t.euler.x,t.euler.y,n)}},"sliderZ")]}),Object(b.jsxs)(H.a,{button:!0,onClick:function(e){t.numSteps=0,t.simulate=!1,t.v=t.v0,t.center(),t.precompute(),t.forceUpdate(),o()},children:[Object(b.jsx)(_.a,{children:Object(b.jsx)(ge.a,{})}),Object(b.jsx)(R.a,{children:"Center Model"})]})]})},"editingGUI"),Object(b.jsx)("div",{className:s.scriptGUI,style:(n.editingScript,{display:"block"}),onPointerOver:function(e){n.GUIHovered=!0},onPointerOut:function(e){n.GUIHovered=!1},children:Object(b.jsx)(Ae,{model:t,sharedData:n,classes:s,updateGUI:o})},"scriptGUI"),Object(b.jsxs)("div",{className:s.editingScriptGUI,style:n.editingScript?{display:"block"}:{display:"none"},onPointerOver:function(e){n.GUIHovered=!0},onPointerOut:function(e){n.GUIHovered=!1},children:[Object(b.jsxs)(F.a,{container:!0,item:!0,spacing:2,alignItems:"center",style:{padding:"".concat(ye,"vh"),paddingTop:"0",paddingBottom:"0",width:"".concat(40.2,"vh")},children:[Object(b.jsx)(F.a,{item:!0,style:{margin:"".concat(Oe,"vh"),width:"10vh",fontSize:"small"},children:"Channels"}),Object(b.jsx)(F.a,{item:!0,style:{margin:"".concat(Oe,"vh"),width:"".concat(20,"vh")},children:Object(b.jsx)(Z.a,{defaultValue:t.Model.defaultNumChannels,"aria-labelledby":"discrete-slider-custom",step:1,min:1,max:5,valueLabelDisplay:"auto",onChange:function(e,n){t.numChannels=n,t.precompute(),o()}},"numChannels")})]},"numChannels"),Object(b.jsxs)(F.a,{container:!0,item:!0,spacing:2,alignItems:"center",style:{padding:"".concat(ye,"vh"),paddingTop:"0",paddingBottom:"0",width:"".concat(40.2,"vh")},children:[Object(b.jsx)(F.a,{item:!0,style:{margin:"".concat(Oe,"vh"),width:"10vh",fontSize:"small"},children:"Actions"}),Object(b.jsx)(F.a,{item:!0,style:{margin:"".concat(Oe,"vh"),width:"".concat(20,"vh")},children:Object(b.jsx)(Z.a,{defaultValue:t.Model.defaultNumActions,"aria-labelledby":"discrete-slider-custom",step:1,min:1,max:20,valueLabelDisplay:"auto",onChange:function(e,n){t.numActions=n,t.precompute(),o()}},"numActions")})]},"numActions")]},"editingScriptGUI"),Object(b.jsx)("div",{className:s.examples,children:Object(b.jsx)(Me,{})},"examples"),Object(b.jsx)("div",{className:s.help,children:Object(b.jsx)(ke,{})},"help")]},Ue=window.location.search,Ie=new URLSearchParams(Ue);window.urlParser=Ie;var Ve="./examples/"+Ie.get("load")+".json",Je=new f;window.model=Je;var De={updateGUI:null,GUIHovered:!1,unSelect:!1,addingJoint:!1,movingJoint:!1,movingBody:!1,removingJoint:!1,showChannel:!1,editingScript:!1,numActions:20,numChannels:4,infoPanel:null,showInfo:!1};Je.sharedData=De,window.sharedData=De,De.infoPanel=document.getElementById("infoPanel"),De.infoPanel||(De.infoPanel=document.createElement("div"),document.body.appendChild(De.infoPanel)),De.infoPanel.id="infoPanel",De.infoPanel.style.background="rgba(255, 255, 255, 0.9)",De.infoPanel.style.position="absolute",De.infoPanel.style.padding="10px",De.infoPanel.appendChild(De.infoPanel.ownerDocument.createTextNode(" ")),window.addEventListener("pointerdown",(function(e){De.unSelect=!0}),!1),window.addEventListener("pointermove",(function(e){De.unSelect=!1}),!1),window.addEventListener("pointerup",(function(e){De.unSelect&&(De.GUIHovered||Je.vStatus.every((function(e){return 1!==e}))&&Je.eStatus.every((function(e){return 1!==e}))&&Je.fStatus.every((function(e){return 1!==e}))&&(Je.vStatus.fill(0),Je.eStatus.fill(0),Je.fStatus.fill(0)),De.updateGUI&&setTimeout((function(){De.updateGUI()}),10))}),!1),window.addEventListener("keydown",(function(e){if("KeyA"===e.code&&(e.metaKey||e.ctrlKey)&&(Je.eStatus.fill(2),Je.vStatus.fill(2)),"KeyZ"!==e.code||!e.metaKey&&!e.ctrlKey||e.shiftKey||(Je.undo(),setTimeout((function(){window.updateModel()}),10)),"KeyZ"===e.code&&(e.metaKey||e.ctrlKey)&&e.shiftKey&&(Je.redo(),setTimeout((function(){window.updateModel()}),10)),"KeyA"===e.code&&Je.editing){for(var t=[],n=0;n<Je.v.length;n++)2===Je.vStatus[n]&&t.push(n);if(1!==t.length)return;Je.addJoint(t[0]),Je.precompute(),Je.recordV(),Je.forceUpdate(),Je.resetSelection()}if("KeyM"===e.code&&Je.editing){var i=!De.movingJoint;De.movingJoint=i,i&&(De.removingJoint=!1,De.addingJoint=!1),Je.simulate=!1,Je.resetSelection(),window.updateGUI()}if("KeyD"===e.code&&Je.editing){for(var a=[],o=0;o<Je.v.length;o++)2===Je.vStatus[o]&&a.push(o);if(1!==a.length)return;Je.removeJoint(a[0]),Je.precompute(),Je.recordV(),Je.forceUpdate(),Je.resetSelection()}if("KeyC"===e.code&&Je.editing){for(var s=[],r=0;r<Je.v.length;r++)2===Je.vStatus[r]&&s.push(r);Je.addEdges(s),Je.precompute(),Je.resetSelection(),Je.forceUpdate()}if("KeyT"===e.code&&Je.editing){for(var c=[],l=0;l<Je.v.length;l++)2===Je.vStatus[l]&&c.push(l);Je.addTet(c),Je.precompute(),Je.forceUpdate(),Je.resetSelection()}if("KeyF"===e.code){for(var h=0;h<Je.v.length;h++)2===Je.vStatus[h]&&(Je.fixedVs[h]=!0);Je.forceUpdate()}if("KeyU"===e.code){for(var d=0;d<Je.v.length;d++)2===Je.vStatus[d]&&(Je.fixedVs[d]=!1);Je.forceUpdate()}if("KeyE"===e.code){if(Je.editing=!Je.editing,Je.editing){De.editingScript=!1,Je.simulate=!1,Je.Model.gravity=!1,De.movingJoint=!1,De.removingJoint=!1,De.addingJoint=!1,Je.center();for(var u=0;u<Je.v.length;u++)Je.vel*=0}Je.editing||(De.movingJoint=!1,De.removingJoint=!1,De.addingJoint=!1,Je.Model.gravity=!0,Je.simulate=!0),Je.controls.current.target=Je.centroid(),window.updateGUI(),Je.forceUpdate()}}),!1),fetch(Ve).then((function(e){return e.text()})).then((function(e){try{var t=JSON.parse(e);Je.loadDict(t),window.data=t,Je.loadDict(t),Je.simulate=!0,Je.Model.gravity=!0,Je.forceUpdate(),De.showChannel=!0}catch(n){}}));var Ge=function(){return console.log(Je),[Object(b.jsx)(z,{model:Je,sharedData:De},"viewer"),Object(b.jsx)(Pe,{id:"hehe",model:Je,sharedData:De},"gui")]},Le=(n(125),n(126),n(127),n(128),n(129),n(130),n(131),"rgba(200, 200, 200, 0.6)");Object(T.a)((function(e){return{mainGUI:{position:"absolute",right:"1.5vh",top:"1.5vh",width:"28vh",height:"auto",background:Le,"& .MuiList-root":{"& .MuiListItem-root":{minHeight:"6vh"}}},editingGUI:{position:"absolute",right:"30vh",top:"1.5vh",width:"30vh",background:Le},scriptGUI:{position:"absolute",left:"2vh",bottom:"2vh",background:Le},editingScriptGUI:{position:"absolute",right:"30vh",top:"44vh",width:"30vh",background:Le},help:{position:"absolute",cursor:"pointer",right:"10px",bottom:"10px",width:"40px",height:"40px",alignContent:"center",background:Le},examples:{position:"absolute",width:"130px",right:"60px",bottom:"10px",height:"40px",background:Le,cursor:"pointer"}}}));var ze=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,138)).then((function(t){var n=t.getCLS,i=t.getFID,a=t.getFCP,o=t.getLCP,s=t.getTTFB;n(e),i(e),a(e),o(e),s(e)}))},Ne=document.getElementById("root");s.a.render(Object(b.jsx)(a.a.StrictMode,{children:Object(b.jsx)(Ge,{})}),Ne),ze()}},[[79,1,2]]]);
//# sourceMappingURL=main.d6daa0c5.chunk.js.map
